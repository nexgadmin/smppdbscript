Wed Oct 16 16:15:01 IST 2024 StartDateTime

NO LONG RUNNING PROCESS FOUND TO BE KILL
SCRIPT ALREADY RUNNING PROCESS EXIT FROM HERE
--------------
ALTER TABLE ERROR_CODE_SUMMARY TRUNCATE PARTITION DATE_20241016
--------------

Query OK, 0 rows affected (1.78 sec)

--------------
INSERT INTO ERROR_CODE_SUMMARY (EVENT_DATE,USER_NAME,SMSC_ID,ERROR_CODE_ID,SMSC_STATUS_CODE,ERROR_DESCRIPTION,PLATFORM,CNT)
SELECT cdt.EVENT_DATE,UPPER(cdt.CHILD_USER_NAME) AS USER_NAME,CASE WHEN cdt.SMSC_ID='' THEN '0' ELSE cdt.SMSC_ID END AS SMSC_ID,cdt.ERROR_CODE_ID, cdt.SMSC_ERROR_CODE,(CASE WHEN sce.errorcode_short_desc IS NOT NULL THEN sce.errorcode_short_desc ELSE cdt.ERROR_CODE_DESCRIPTION END) AS ERROR_DESCRIPTION,cdt.PLATFORM,SUM(cdt.PARTS) AS CNT FROM CDRS_TEXT PARTITION(DATE_20241016) cdt LEFT JOIN sms_error_code sce ON cdt.ERROR_CODE_ID = sce.error_code WHERE cdt.ERROR_CODE_ID NOT IN ('0','000') AND cdt.CHILD_USER_NAME != '' GROUP BY 1,2,3,4,5,6
--------------

Query OK, 3458 rows affected (1 min 6.32 sec)
Records: 3458  Duplicates: 0  Warnings: 0

--------------
UPDATE ERROR_CODE_SUMMARY PARTITION(DATE_20241016) A, SMSC_ID_MST B SET A.SMSC_NAME=B.SMSC_NAME
WHERE A.SMSC_ID=B.SMSC_ID AND A.PLATFORM=B.PLATFORM AND A.SMSC_NAME IS NULL
--------------

Query OK, 3448 rows affected (0.09 sec)
Rows matched: 3448  Changed: 3448  Warnings: 0

--------------
ALTER TABLE HEADER_REPORT TRUNCATE PARTITION DATE_20241016
--------------

Query OK, 0 rows affected (1.74 sec)

--------------
INSERT INTO HEADER_REPORT (EVENT_DATE,SENDER_ID,USER_NAME,DLT_PE_ID,DLT_CT_ID,SUBMITION,DELIVERED,PLATFORM)
SELECT EVENT_DATE,UPPER(SENDER_ID) AS SENDER_ID,UPPER(IFNULL(NULLIF(CHILD_USER_NAME,''),'NEXGCP1')) AS USER_NAME,DLT_PE_ID,DLT_CT_ID,
SUM(PARTS) AS SUBMITION,SUM(CASE WHEN ERROR_CODE_ID IN('0','000') THEN PARTS ELSE 0 END) AS DELIVERED,PLATFORM
FROM CDRS_TEXT PARTITION(DATE_20241016) GROUP BY 1,2,3,4,5
--------------

Query OK, 22013 rows affected (2 min 27.46 sec)
Records: 22013  Duplicates: 0  Warnings: 0

Bye
removed '/data01/shfiles/file_cute/lock.log'

Wed Oct 16 16:16:06 IST 2024 EndDateTime
365 Sec
min_seq = 2278209579 :: max_seq = 2278536333 :: cdrs_count = 159956
Pending 123787

